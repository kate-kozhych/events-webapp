<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="jakarta.faces.html" xmlns:f="http://xmlns.jcp.org/jsf/core">
<f:metadata>
    <f:event type="preRenderView" listener="#{userController.loadUserData}" />
</f:metadata>
<h:head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Profile - ESNts</title>
    <link rel="preload" href="#{request.contextPath}/resources/css/style2.css" as="style" />
    <h:outputStylesheet library="css" name="style2.css" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

</h:head>
<h:body>
    <div class="container">
        <!-- Left Content Section -->
        <div class="dark-column left"></div>

        <!-- User Profile Section -->
        <div class="signup-section">
            <h1>Edit Profile</h1>
            <div class="profile-icon">
                <img src="#{request.contextPath}/resources/images/user-128.png" alt="User Icon" />
            </div>

            <h:messages globalOnly="true" styleClass="alert alert-danger" style="list-style-type: none; color: red; font-weight: bold; margin: 10px 0;" />

            <!-- JSF Form for updating user information -->
            <h:form>
                <h:inputHidden value="#{userController.user.id}" />
                <f:metadata>
                    <f:event type="preRenderView" listener="#{userController.loadUserData}" />
                </f:metadata>

                <!-- Name & Surname Row -->
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <h:outputLabel for="name" value="Name" />
                        <h:inputText id="name" value="#{userController.user.name}" class="form-control mb-3" required="true"
                                     requiredMessage="Name is required">
                            <f:validateLength minimum="1" />
                        </h:inputText>
                        <h:message for="name" styleClass="error-message" />
                    </div>
                    <div class="form-group col-md-6">
                        <h:outputLabel for="surname" value="Surname" />
                        <h:inputText id="surname" value="#{userController.user.surname}" class="form-control mb-3" required="true"
                                     requiredMessage="Surname is required">
                            <f:validateLength minimum="1" />
                        </h:inputText>
                        <h:message for="surname" styleClass="error-message" />
                    </div>
                </div>

                <!-- Age Field -->
                <div class="form-group">
                    <h:outputLabel for="age" value="Age" />
                    <h:inputText id="age" value="#{userController.user.age}" class="form-control mb-3"
                                 required="true" requiredMessage="Age is required">
                        <f:validateLongRange minimum="18" maximum="100" />
                    </h:inputText>
                    <h:message for="age" styleClass="error-message" />
                </div>

                <!-- Student Email -->
                <div class="form-group">
                    <h:outputLabel for="email" value="Student email" />
                    <h:inputText id="email" value="#{userController.user.ujaEmail}" class="form-control mb-3" required="true"
                                 requiredMessage="Email is required">
                        <f:validateLength minimum="1" />
                    </h:inputText>
                    <h:message for="email" styleClass="error-message" />
                </div>

                <div class="form-group">
                    <h:outputLabel for="esnCard" value="ESN Card Number" />
                    <h:inputText id="esnCard" value="#{userController.user.esnCard}" class="form-control mb-3" readonly="true"/>
                </div>

                <!-- Password field -->
                <div class="form-group">
                    <h:outputLabel for="password" value="Password" />
                    <h:inputSecret id="password" value="#{userController.user.password}" class="form-control mb-3" required="true"
                                   requiredMessage="Password is required">
                        <f:validateLength minimum="6" />
                    </h:inputSecret>
                    <h:message for="password" styleClass="error-message" />
                </div>

                <div class="buttons-container">
                    <h:commandButton value="Apply Changes" action="#{userController.updateUserInfo}" class="signup-button mb-3"/>
                </div>
                <div style="text-align: center; margin-top: 10px;">
                    <a href="userlist.xhtml" class="btn" style="background-color: #888; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">Back to Users</a>
                </div>

            </h:form>
        </div>

        <!-- Right Content Section -->
        <div class="dark-column right"></div>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js" type="text/javascript"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" type="text/javascript"></script>
</h:body>
</html>